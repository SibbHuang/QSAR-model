# QSAR-model

Some jupyte format codes and origin data used in my study to build the QSAR model about DPPH scavenging activity.

### 1. Create New Environment:
My python version is 3.6.13 and I have the following environment installed:

```python
'pandas==1.1.5'
'pyqsar==1.3'
'sklearn==0.24.2'
'rdkit==2021.09.4'
'seaborn==0.11.2'
'numpy==1.19.2'
'matplotlib==3.3.4'
'scipy==1.5.4'
'bokeh==2.3.3'
'pickle5==0.0.12'
```

The method for creating a new environment is as follows:
Generate a new environment named pyqsar：

```python
conda create -n pyqsar python=3.6
```

Activate the environment and use pip to configure it according to the provided requirements.txt：

```python
conda activate pyqsar
pip install -r requirements.txt
```

### 2.Main functions of each document：

First, the **Select feature by using PyQSAR.ipynb** file is used to clean the data, in which the collected descriptors are filtered for initial cleaning and modeling descriptor combinations.

Afterward，the **Get Correlation Matrix.ipynb** was utilized to visualizate of correlation matrix and correlation coefficients. Some matrix graph were saved in folder named **f1_60matrix_png.zip** which were generated by 60 different descriptor groups in my study. And the file **Get new Variable by PCA analysis.ipynb** enables PCA analysis of the output descriptor combination csv file for data dimensionality reduction.

Accroding to the matrix graph, the descriptors group which highly relevant descriptors (|r| > 0.6) were removed and these dataframes were saved in folder **f1_45rmc_csv.zip**.

Multiple linear regressions can be executed in **MultipleLinearRegression.ipynb**, via the csv file generated earlier. Models were generated through 100% TRAINING SET and cross-validated through 5 k-fold. Finally, the r2, q2 and RMSE parameters were used to assess the predictability of the model. Additionally, the module of Pickle was used to save the model which will facilitate prediction of new data.

The models generated in this study were stored in files "**datad9.pickle**" and "**datad12.pickle**", respectively.

### 3.Prediction for New data ：

Novel peptide extract from *Porphyra* proteins were screened by ADMET analysis. The 3D structure of these peptides were generated by RDKit package. The SDF files of these peptides were sortedand merged in SDF file named. 

Next, 1D-3D descriptors were obtained from PaDEL. The data also stored at file "**peptideDresult.csv**" in current path. Using the **PredictNewData.ipynb** to predict its bioactivity and export to csv file. Two models predictive result were exported to the file **pIC50report_d9.csv** and **pIC50report_d12.csv**, respectively.

